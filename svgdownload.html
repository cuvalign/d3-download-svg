<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>wordtree</title>
</head>
<body>
<script src="https://cdn.bootcdn.net/ajax/libs/d3/3.5.1/d3.js" charset="utf-8"></script>
<script>
    "use strict"
    var w=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;
    var h=window.innerHeight||document.documentElement.clientWidth||document.body.clientHeight;
	var mySvg  = d3.select("body") //选择<body>里的svgbox
        .append("svg") //在<body>中添加<svg>
		.attr("width",w*0.98)
		.attr("height",h*0.98).node()

    var rate=0.7;
    var x0=w*0.5;
    var y0=h*0.65;
    var count=7;
    var str='猛男色文字树';
    var fontsize=count*2;
    var length=str.length*fontsize;
    var numcount=0;
    var title2=document.createElement("text");
    mySvg.appendChild(title2)
    function show(x0,y0,length,rate,a,count){
        var fontsize=count*2
        var length=str.length*fontsize;
        var x1=x0;
        var y1=y0;
        var x2=x1+length*Math.cos(a)
        var y2=y1+length*Math.sin(a)
        numcount=numcount+1;
        var myTest2=document.createElement("text");
        mySvg.appendChild(myTest2);
        myTest2.outerHTML="<text id="+numcount+" x="+x1+" y="+y1+" style='fill:rgb("+(255-10*count)+","+(230-20*count)+","+(230-20*count)+");font-size:"+fontsize+"' transform='rotate("+a*180/Math.PI+","+x1+","+y1+")'>"+str+"</text>";
        var ahl=a-Math.PI/5*(0.7+0.3*Math.random());
        var ahr=a+Math.PI/3*(0.7+0.3*Math.random());
        var all=a-Math.PI/3;
        if(count<=1){
            var myCircle=document.createElement("ellipse");
            mySvg.appendChild(myCircle);
            // myCircle.outerHTML="<circle cx="+x1+" cy="+y1+" r="+(6*Math.random())+" stroke='pink' stroke-width='2.5' fill='red'/>";  
            myCircle.outerHTML="<ellipse cx="+x1+" cy="+y1+" rx="+(6*Math.random())+" ry="+(3*Math.random())+" fill='red' stroke='pink' stroke-width='2.5'/>"    
          }
        if(count>0){
            show(x2,y2,length*rate,rate,ahl,count-1);
            show(x2,y2,length*rate,rate,ahr,count-1);
            show(x2,y2,length*rate,rate,all,count-1);
        }
    }
    show(x0,y0,length,rate,-Math.PI/2,count);
</script>

</body>